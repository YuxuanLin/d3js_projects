<!DOCTYPE html>
<style>
    path { 
        stroke: steelblue;
        stroke-width: 2;
        fill: none;
    }
    .axis path,
    .axis line {
        stroke: grey;
        stroke-width: 1;
        shape-rendering: crispEdges;
    }
    div.tooltip {
	    position: absolute;    
	    text-align: center;    
	    width: 60px;    
	    height: 28px;        
	    padding: 2px;    
	    font: 12px sans-serif;    
	    background: lightsteelblue;    
	    border: 0px;                    
	    border-radius: 8px;
	}

</style>
<html>
   	<head>
   		<title>D3 Assignment</title>
     	<script type="text/javascript" src="d3.min.js"></script>
     	
   	</head>
   	<body>
   		<div id="container">
	      	<h1 id="headline">Multiple lines chart for two shops</p>
    	</div> 
   		<script type="text/javascript">
		    //Read data and process data
			d3.json("./flat.json", function(error, root) {
						// {
						//  	"name":"Branch",
						//  	"children": [
						//  		"name":"AssetName",
						//  		"children":[
						//  			"name":"ResourceCategory",
						//  			"size":1188555.396
						//  		]
						//  	]
						// }

		       	var newData = {
				    	"key":"World", 
				    	"values": 
				        d3.nest()
				            .key(function(d){return d.Branch})
				            .key(function(d){return d.AssetName})
				            .key(function(d){return d.ResourceCategory})
				            .key(function(d){return d.TotalCO2})
				            .entries(root)
						}

		// var treeData= { "key": "World", "values": 
		//         d3.nest()
		//         .key(function (d) { return d.Major_Region; })
		//         .key(function (d) { return d.Region; })
		//         .key(function (d) { return d.Country; })
		//         .entries(pop)
		//       };

		var treeData2 = { 
			"name": "World", 
			"children": newData.values.map( function(Branch){
	        return { 
	        	"name": Branch.key, 
	        	"children": Branch.values.map( function(AssetName){
	            return { 
	             	"name": AssetName.key, 
	             	"children": AssetName.values.map(function(ResourceCategory){
	                return { 
	                	"name": ResourceCategory.key, 
	                	"children": ResourceCategory.values 
	                };
	              }) //end of map(function(country){
	            };
	          }) //end of map(function(region){
	        }; 
	      }) //end of map(function(major){
		  }; //end of var declaration
		        console.log(treeData2);  





				
			});
        </script>
   	</body>
</html>